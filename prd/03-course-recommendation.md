# PRD: AI 기반 데이트 코스 추천

## 1. 기능 개요
**핵심 가치:** 사용자가 선택한 장소들을 기반으로 AI가 최적의 동선, 시간 배분, 카테고리 다양성을 고려하여 효율적인 데이트 코스를 자동 생성하고 개인화된 추천을 제공한다.

**사용자 이점:** 복잡한 경로 계산과 시간 조율을 AI가 자동 처리하여 5분 내에 완성도 높은 데이트 코스를 얻을 수 있다.

---

## 2. 페르소나(Persona)
**주 사용자:** 현우(27세, 회계사)
- **맥락:** 주말마다 여자친구와 데이트하지만 매번 코스 짜는 게 스트레스. 이동 시간 계산과 영업시간 확인이 번거로움
- **목표:** 저장해둔 장소들로 하루 종일 즐길 수 있는 최적 코스를 빠르게 생성하여 데이트 계획 수립 시간 최소화
- **동기:** 더 많은 시간을 연인과의 실제 데이트에 투자하고 싶음
- **제약:** 복잡한 설정은 싫어하고, 추천 결과가 비효율적이면 직접 짜는 게 나을 정도
- **성공 정의:** 3개 장소 선택 후 5분 내 완성된 코스 획득, 실제 이동시간이 예상과 10% 이내 오차

**핵심 Pain Points:**
1. **동선 비효율:** 거리 상 가까운 곳들을 순서대로 가지 않아 이동시간 낭비
2. **시간 배분 실패:** 영업시간/혼잡도 미고려로 문 닫은 곳 방문하거나 대기시간 과다
3. **카테고리 불균형:** 카페만 3곳 또는 식당만 연속으로 가는 등 단조로운 구성

---

## 3. 유저 스토리(User Stories)
- **코스 기획자**로서, 위시리스트에서 3-6개 장소를 선택하면 최적 순서로 배열된 코스를 받고 싶다. 그래서 이동시간을 최소화한다.
- **시간 관리자**로서, 각 장소별 예상 소요시간과 이동시간이 표시된 타임라인을 보고 싶다. 그래서 하루 일정을 정확히 계획한다.
- **다양성 추구자**로서, 카테고리(카페-맛집-관광지)가 적절히 조합된 코스를 추천받고 싶다. 그래서 균형 잡힌 데이트를 즐긴다.
- **개인화 사용자**로서, 선호도(이동수단, 시간대, 예산)를 반영한 맞춤 코스를 받고 싶다. 그래서 만족도 높은 데이트를 한다.

---

## 4. 유저 플로우(User Flow)

### 4-1. 코스 생성 플로우
1. **장소 선택:** 위시리스트에서 3-6개 장소 다중 선택
2. **조건 설정:** 이동수단(도보/대중교통/자차), 시작 시간, 선호 카테고리 순서 (선택사항)
3. **AI 분석:** 거리 최적화, 영업시간 조회, 혼잡도 예측, 카테고리 밸런싱
4. **코스 생성:** 순서 배열 + 예상 소요시간 + 이동경로 계산
5. **결과 표시:** 타임라인 형태로 시각화 + 총 소요시간/이동거리 요약

### 4-2. 코스 편집 플로우
1. **순서 변경:** 드래그 앤 드롭으로 장소 순서 조정
2. **장소 교체:** 기존 장소 삭제 + 위시리스트에서 새 장소 추가
3. **시간 조정:** 각 장소별 체류시간 수동 조정
4. **재계산:** 변경사항 반영하여 이동시간/도착시간 업데이트

### 4-3. 코스 저장/공유 플로우
1. **코스 명명:** 사용자 정의 코스 이름 입력
2. **저장:** 내 코스 목록에 추가
3. **공유 준비:** 공유 링크/이미지 생성
4. **공유 실행:** 메신저/SNS로 전송

### 4-4. 에러/빈 상태 플로우
- **장소 부족:** 2개 이하 선택 시 "최소 3개 장소 필요" 안내
- **영업시간 충돌:** 문닫은 시간 방문 시 대안 시간 제안 또는 장소 교체 권유
- **거리 과다:** 총 이동시간 3시간 초과 시 장소 개수 줄이기 제안
- **생성 실패:** AI 오류 시 기본 거리순 정렬로 fallback

---

## 5. 수용 기준(Acceptance Criteria)

| ID | 시나리오 | Given | When | Then |
|----|----------|-------|------|------|
| AC-01 | 기본 코스 생성 | 3-6개 장소 선택됨 | 코스 생성 실행 | 10초 이내 최적 순서로 배열된 코스 표시 |
| AC-02 | 이동시간 최적화 | 지리적으로 분산된 장소들 | 코스 생성 시 | 총 이동시간이 무작위 순서 대비 30% 이상 단축 |
| AC-03 | 영업시간 고려 | 영업시간 정보 있는 장소 | 방문 시간 계산 시 | 영업시간 내 방문하도록 스케줄 배치 |
| AC-04 | 카테고리 다양성 | 서로 다른 카테고리 장소들 | 코스 생성 시 | 동일 카테고리 연속 방문 최대 2곳으로 제한 |
| AC-05 | 코스 편집 반영 | 생성된 코스 존재 | 사용자가 순서 변경 시 | 실시간으로 이동시간/도착시간 재계산 |
| AC-06 | 실현 가능성 검증 | 하루 코스로 구성 | 총 시간 계산 시 | 10시간 이내 완주 가능한 코스만 생성 |
| AC-07 | 개인화 반영 | 이동수단/시간대 설정 | 코스 생성 시 | 설정된 조건에 맞는 경로/시간 계산 |

---

## 6. 상충/의존성 점검(Conflict Matrix)

| 항목 | 잠재 충돌 | 정책/해결 |
|------|-----------|-----------|
| 최적 거리 vs 카테고리 다양성 | 거리순 배치와 카테고리 섞기 상충 | 거리 가중치 70% + 카테고리 다양성 30%로 절충 |
| 영업시간 vs 사용자 선호시간 | 늦은 시작 vs 이른 마감시간 충돌 | 영업시간 우선, 불가능 시 대안 시간/장소 제안 |
| 이동수단별 경로 차이 | 도보/대중교통/자차 최적경로 상이 | 선택된 이동수단 기준으로 경로 계산, 혼합 이동 지원 |
| 실시간 vs 캐시 정보 | 최신 영업시간 vs 빠른 응답 | 캐시 우선 사용, 백그라운드 실시간 검증으로 오차 최소화 |

---

## 7. 기능별 상세 명세

### 7-1. AI 추천 알고리즘
```
가중치 기반 점수 계산:
- 이동거리 최적화: 40%
- 영업시간 적합성: 25%  
- 카테고리 다양성: 20%
- 혼잡도 회피: 10%
- 개인 선호도: 5%
```

### 7-2. 시간 계산 로직
```
각 장소별 기본 체류시간:
- 카페: 60분
- 맛집: 90분 (점심/저녁 시간대 +30분)
- 관광지: 120분
- 쇼핑: 90분
- 문화시설: 150분
- 액티비티: 180분

이동시간 계산:
- 도보: 평균 속도 4km/h + 신호대기 10%
- 대중교통: 구글 맵 API + 환승시간 추가
- 자차: 카카오 내비 API + 주차시간 10분
```

### 7-3. 코스 데이터 스키마
```json
{
  "id": "string",
  "name": "string",
  "places": [
    {
      "placeId": "string",
      "order": "number",
      "arrivalTime": "HH:mm",
      "departureTime": "HH:mm", 
      "stayDuration": "number (minutes)",
      "travelToNext": {
        "duration": "number (minutes)",
        "distance": "number (meters)",
        "method": "walking|transit|driving"
      }
    }
  ],
  "totalDuration": "number (minutes)",
  "totalDistance": "number (meters)",
  "createdAt": "timestamp",
  "preferences": {
    "transportMethod": "string",
    "startTime": "HH:mm",
    "categoryOrder": "string[]"
  }
}
```

### 7-4. 최적화 제약조건
- **최소 장소:** 3곳
- **최대 장소:** 6곳 (하루 코스 기준)
- **총 소요시간:** 4-10시간 범위
- **이동반경:** 반경 20km 이내 권장

---

## 8. KPI / 측정 지표

### 8-1. 생성 성능
- **생성 성공률:** 코스 생성 시도 → 완성된 코스 제공 ≥ 95%
- **생성 속도:** 평균 응답시간 ≤ 10초
- **최적화 효과:** AI 추천 vs 거리순 정렬 이동시간 단축률 ≥ 25%

### 8-2. 사용자 만족도
- **코스 수락률:** 생성된 코스를 그대로 저장하는 비율 ≥ 60%
- **편집 빈도:** 생성 후 수정 없이 사용하는 비율 ≥ 40%
- **실행률:** 저장된 코스를 실제 이용하는 비율 ≥ 30%

### 8-3. 품질 지표
- **시간 정확도:** 예상 vs 실제 소요시간 오차 ≤ 20%
- **영업시간 준수율:** 영업시간 내 방문 스케줄링 정확도 ≥ 90%
- **재사용률:** 동일 코스를 다시 이용하는 비율 ≥ 15%

---

## 9. UI/UX 가이드라인

### 9-1. 코스 생성 화면
```
[장소 선택 영역]
☑️ 카페 A    ☑️ 맛집 B    ☑️ 관광지 C
☑️ 카페 D    ⬜ 쇼핑몰 E  ⬜ 박물관 F

[설정 영역 - 접기/펼치기]
🚶 이동수단: 도보 | 대중교통 | 자차
⏰ 시작시간: 10:00 AM
📋 선호순서: 카페→관광지→맛집

[생성 버튼]
🎯 AI 코스 생성하기
```

### 9-2. 코스 결과 화면
```
📍 오늘의 데이트 코스 (총 6시간 30분)

10:00 - 11:00  ☕ 카페 A (60분)
       ↓ 도보 5분
11:05 - 1:05   🏛️ 관광지 C (120분)  
       ↓ 도보 10분
1:15 - 2:45    🍽️ 맛집 B (90분)
       ↓ 도보 8분  
2:53 - 4:23    ☕ 카페 D (90분)

💡 총 이동: 23분 | 총 거리: 1.8km
```

### 9-3. 편집 인터랙션
- **드래그 앤 드롭:** 장소 순서 변경
- **시간 슬라이더:** 체류시간 조정 (30분~3시간)
- **장소 교체:** X 버튼 → 대체 장소 추천 팝업

---

## 10. 접근성 / 국제화

### 10-1. 접근성
- **시각 장애:** 코스 순서를 음성으로 읽어주는 기능
- **운동 장애:** 드래그 대신 버튼 기반 순서 변경 옵션
- **인지 부담 최소화:** 복잡한 설정은 고급 옵션으로 숨김

### 10-2. 국제화
- **시간 형식:** 12시간/24시간제 선택
- **거리 단위:** km/mile 자동 전환
- **이동수단:** 지역별 대중교통 옵션 반영

---

## 11. 외부 의존성

### 11-1. 지도/경로 API
- **주 사용:** 카카오 맵 API (경로 탐색, 소요시간)
- **보조:** Google Maps API (대중교통 정보)

### 11-2. 영업시간 데이터
- **실시간:** 네이버 플레이스, 카카오맵 크롤링
- **백업:** 사용자 제보, 수동 업데이트

### 11-3. 혼잡도 정보
- **기본:** 카카오맵 실시간 혼잡도
- **보강:** 과거 방문 패턴 분석

---

## 12. 용어 사전(Glossary)
- **코스:** 여러 장소를 순서대로 방문하는 하루 일정
- **최적화:** 이동시간/거리/만족도를 종합적으로 고려한 배치
- **타임라인:** 시간 순서로 배열된 코스 일정표
- **체류시간:** 각 장소에서 보내는 예상 시간
- **카테고리 밸런싱:** 다양한 장소 유형의 적절한 조합

---

## 13. 기술 제약
- **AI 모델:** 경로 최적화 알고리즘 (유전 알고리즘 또는 시뮬레이티드 어닐링)
- **실시간 처리:** 10초 이내 응답 보장
- **동시 사용자:** 100명 동시 코스 생성 지원
- **데이터 캐시:** 영업시간/거리 정보 6시간 TTL

---

## Changelog
- 2025-01-XX: 초기 문서 작성 (작성자: Claude)